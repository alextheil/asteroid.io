{"ast":null,"code":"\"use strict\";\n/**\n * Copyright (c) 2014 Ion Drive Software Ltd.\n * https://github.com/darrachequesne/notepack/\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Patch for Colyseus:\n * -------------------\n *\n * added `offset` on Decoder constructor, for messages arriving with a code\n * before actual msgpack data\n */\n\nfunction Decoder(buffer, offset) {\n  this._offset = offset;\n\n  if (buffer instanceof ArrayBuffer) {\n    this._buffer = buffer;\n    this._view = new DataView(this._buffer);\n  } else if (ArrayBuffer.isView(buffer)) {\n    this._buffer = buffer.buffer;\n    this._view = new DataView(this._buffer, buffer.byteOffset, buffer.byteLength);\n  } else {\n    throw new Error('Invalid argument');\n  }\n}\n\nfunction utf8Read(view, offset, length) {\n  var string = '',\n      chr = 0;\n\n  for (var i = offset, end = offset + length; i < end; i++) {\n    var byte = view.getUint8(i);\n\n    if ((byte & 0x80) === 0x00) {\n      string += String.fromCharCode(byte);\n      continue;\n    }\n\n    if ((byte & 0xe0) === 0xc0) {\n      string += String.fromCharCode((byte & 0x1f) << 6 | view.getUint8(++i) & 0x3f);\n      continue;\n    }\n\n    if ((byte & 0xf0) === 0xe0) {\n      string += String.fromCharCode((byte & 0x0f) << 12 | (view.getUint8(++i) & 0x3f) << 6 | (view.getUint8(++i) & 0x3f) << 0);\n      continue;\n    }\n\n    if ((byte & 0xf8) === 0xf0) {\n      chr = (byte & 0x07) << 18 | (view.getUint8(++i) & 0x3f) << 12 | (view.getUint8(++i) & 0x3f) << 6 | (view.getUint8(++i) & 0x3f) << 0;\n\n      if (chr >= 0x010000) {\n        // surrogate pair\n        chr -= 0x010000;\n        string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n      } else {\n        string += String.fromCharCode(chr);\n      }\n\n      continue;\n    }\n\n    throw new Error('Invalid byte ' + byte.toString(16));\n  }\n\n  return string;\n}\n\nDecoder.prototype._array = function (length) {\n  var value = new Array(length);\n\n  for (var i = 0; i < length; i++) {\n    value[i] = this._parse();\n  }\n\n  return value;\n};\n\nDecoder.prototype._map = function (length) {\n  var key = '',\n      value = {};\n\n  for (var i = 0; i < length; i++) {\n    key = this._parse();\n    value[key] = this._parse();\n  }\n\n  return value;\n};\n\nDecoder.prototype._str = function (length) {\n  var value = utf8Read(this._view, this._offset, length);\n  this._offset += length;\n  return value;\n};\n\nDecoder.prototype._bin = function (length) {\n  var value = this._buffer.slice(this._offset, this._offset + length);\n\n  this._offset += length;\n  return value;\n};\n\nDecoder.prototype._parse = function () {\n  var prefix = this._view.getUint8(this._offset++);\n\n  var value,\n      length = 0,\n      type = 0,\n      hi = 0,\n      lo = 0;\n\n  if (prefix < 0xc0) {\n    // positive fixint\n    if (prefix < 0x80) {\n      return prefix;\n    } // fixmap\n\n\n    if (prefix < 0x90) {\n      return this._map(prefix & 0x0f);\n    } // fixarray\n\n\n    if (prefix < 0xa0) {\n      return this._array(prefix & 0x0f);\n    } // fixstr\n\n\n    return this._str(prefix & 0x1f);\n  } // negative fixint\n\n\n  if (prefix > 0xdf) {\n    return (0xff - prefix + 1) * -1;\n  }\n\n  switch (prefix) {\n    // nil\n    case 0xc0:\n      return null;\n    // false\n\n    case 0xc2:\n      return false;\n    // true\n\n    case 0xc3:\n      return true;\n    // bin\n\n    case 0xc4:\n      length = this._view.getUint8(this._offset);\n      this._offset += 1;\n      return this._bin(length);\n\n    case 0xc5:\n      length = this._view.getUint16(this._offset);\n      this._offset += 2;\n      return this._bin(length);\n\n    case 0xc6:\n      length = this._view.getUint32(this._offset);\n      this._offset += 4;\n      return this._bin(length);\n    // ext\n\n    case 0xc7:\n      length = this._view.getUint8(this._offset);\n      type = this._view.getInt8(this._offset + 1);\n      this._offset += 2;\n      return [type, this._bin(length)];\n\n    case 0xc8:\n      length = this._view.getUint16(this._offset);\n      type = this._view.getInt8(this._offset + 2);\n      this._offset += 3;\n      return [type, this._bin(length)];\n\n    case 0xc9:\n      length = this._view.getUint32(this._offset);\n      type = this._view.getInt8(this._offset + 4);\n      this._offset += 5;\n      return [type, this._bin(length)];\n    // float\n\n    case 0xca:\n      value = this._view.getFloat32(this._offset);\n      this._offset += 4;\n      return value;\n\n    case 0xcb:\n      value = this._view.getFloat64(this._offset);\n      this._offset += 8;\n      return value;\n    // uint\n\n    case 0xcc:\n      value = this._view.getUint8(this._offset);\n      this._offset += 1;\n      return value;\n\n    case 0xcd:\n      value = this._view.getUint16(this._offset);\n      this._offset += 2;\n      return value;\n\n    case 0xce:\n      value = this._view.getUint32(this._offset);\n      this._offset += 4;\n      return value;\n\n    case 0xcf:\n      hi = this._view.getUint32(this._offset) * Math.pow(2, 32);\n      lo = this._view.getUint32(this._offset + 4);\n      this._offset += 8;\n      return hi + lo;\n    // int\n\n    case 0xd0:\n      value = this._view.getInt8(this._offset);\n      this._offset += 1;\n      return value;\n\n    case 0xd1:\n      value = this._view.getInt16(this._offset);\n      this._offset += 2;\n      return value;\n\n    case 0xd2:\n      value = this._view.getInt32(this._offset);\n      this._offset += 4;\n      return value;\n\n    case 0xd3:\n      hi = this._view.getInt32(this._offset) * Math.pow(2, 32);\n      lo = this._view.getUint32(this._offset + 4);\n      this._offset += 8;\n      return hi + lo;\n    // fixext\n\n    case 0xd4:\n      type = this._view.getInt8(this._offset);\n      this._offset += 1;\n\n      if (type === 0x00) {\n        this._offset += 1;\n        return void 0;\n      }\n\n      return [type, this._bin(1)];\n\n    case 0xd5:\n      type = this._view.getInt8(this._offset);\n      this._offset += 1;\n      return [type, this._bin(2)];\n\n    case 0xd6:\n      type = this._view.getInt8(this._offset);\n      this._offset += 1;\n      return [type, this._bin(4)];\n\n    case 0xd7:\n      type = this._view.getInt8(this._offset);\n      this._offset += 1;\n\n      if (type === 0x00) {\n        hi = this._view.getInt32(this._offset) * Math.pow(2, 32);\n        lo = this._view.getUint32(this._offset + 4);\n        this._offset += 8;\n        return new Date(hi + lo);\n      }\n\n      return [type, this._bin(8)];\n\n    case 0xd8:\n      type = this._view.getInt8(this._offset);\n      this._offset += 1;\n      return [type, this._bin(16)];\n    // str\n\n    case 0xd9:\n      length = this._view.getUint8(this._offset);\n      this._offset += 1;\n      return this._str(length);\n\n    case 0xda:\n      length = this._view.getUint16(this._offset);\n      this._offset += 2;\n      return this._str(length);\n\n    case 0xdb:\n      length = this._view.getUint32(this._offset);\n      this._offset += 4;\n      return this._str(length);\n    // array\n\n    case 0xdc:\n      length = this._view.getUint16(this._offset);\n      this._offset += 2;\n      return this._array(length);\n\n    case 0xdd:\n      length = this._view.getUint32(this._offset);\n      this._offset += 4;\n      return this._array(length);\n    // map\n\n    case 0xde:\n      length = this._view.getUint16(this._offset);\n      this._offset += 2;\n      return this._map(length);\n\n    case 0xdf:\n      length = this._view.getUint32(this._offset);\n      this._offset += 4;\n      return this._map(length);\n  }\n\n  throw new Error('Could not parse');\n};\n\nfunction decode(buffer, offset) {\n  if (offset === void 0) {\n    offset = 0;\n  }\n\n  var decoder = new Decoder(buffer, offset);\n\n  var value = decoder._parse();\n\n  if (decoder._offset !== buffer.byteLength) {\n    throw new Error(buffer.byteLength - decoder._offset + ' trailing bytes');\n  }\n\n  return value;\n}\n\nexports.default = decode;","map":{"version":3,"sources":["C:/Courses/PROG20261/asteroid.io/node_modules/colyseus.js/lib/msgpack/decode.js"],"names":["Object","defineProperty","exports","value","Decoder","buffer","offset","_offset","ArrayBuffer","_buffer","_view","DataView","isView","byteOffset","byteLength","Error","utf8Read","view","length","string","chr","i","end","byte","getUint8","String","fromCharCode","toString","prototype","_array","Array","_parse","_map","key","_str","_bin","slice","prefix","type","hi","lo","getUint16","getUint32","getInt8","getFloat32","getFloat64","Math","pow","getInt16","getInt32","Date","decode","decoder","default"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * Copyright (c) 2014 Ion Drive Software Ltd.\n * https://github.com/darrachequesne/notepack/\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Patch for Colyseus:\n * -------------------\n *\n * added `offset` on Decoder constructor, for messages arriving with a code\n * before actual msgpack data\n */\nfunction Decoder(buffer, offset) {\n    this._offset = offset;\n    if (buffer instanceof ArrayBuffer) {\n        this._buffer = buffer;\n        this._view = new DataView(this._buffer);\n    }\n    else if (ArrayBuffer.isView(buffer)) {\n        this._buffer = buffer.buffer;\n        this._view = new DataView(this._buffer, buffer.byteOffset, buffer.byteLength);\n    }\n    else {\n        throw new Error('Invalid argument');\n    }\n}\nfunction utf8Read(view, offset, length) {\n    var string = '', chr = 0;\n    for (var i = offset, end = offset + length; i < end; i++) {\n        var byte = view.getUint8(i);\n        if ((byte & 0x80) === 0x00) {\n            string += String.fromCharCode(byte);\n            continue;\n        }\n        if ((byte & 0xe0) === 0xc0) {\n            string += String.fromCharCode(((byte & 0x1f) << 6) |\n                (view.getUint8(++i) & 0x3f));\n            continue;\n        }\n        if ((byte & 0xf0) === 0xe0) {\n            string += String.fromCharCode(((byte & 0x0f) << 12) |\n                ((view.getUint8(++i) & 0x3f) << 6) |\n                ((view.getUint8(++i) & 0x3f) << 0));\n            continue;\n        }\n        if ((byte & 0xf8) === 0xf0) {\n            chr = ((byte & 0x07) << 18) |\n                ((view.getUint8(++i) & 0x3f) << 12) |\n                ((view.getUint8(++i) & 0x3f) << 6) |\n                ((view.getUint8(++i) & 0x3f) << 0);\n            if (chr >= 0x010000) { // surrogate pair\n                chr -= 0x010000;\n                string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n            }\n            else {\n                string += String.fromCharCode(chr);\n            }\n            continue;\n        }\n        throw new Error('Invalid byte ' + byte.toString(16));\n    }\n    return string;\n}\nDecoder.prototype._array = function (length) {\n    var value = new Array(length);\n    for (var i = 0; i < length; i++) {\n        value[i] = this._parse();\n    }\n    return value;\n};\nDecoder.prototype._map = function (length) {\n    var key = '', value = {};\n    for (var i = 0; i < length; i++) {\n        key = this._parse();\n        value[key] = this._parse();\n    }\n    return value;\n};\nDecoder.prototype._str = function (length) {\n    var value = utf8Read(this._view, this._offset, length);\n    this._offset += length;\n    return value;\n};\nDecoder.prototype._bin = function (length) {\n    var value = this._buffer.slice(this._offset, this._offset + length);\n    this._offset += length;\n    return value;\n};\nDecoder.prototype._parse = function () {\n    var prefix = this._view.getUint8(this._offset++);\n    var value, length = 0, type = 0, hi = 0, lo = 0;\n    if (prefix < 0xc0) {\n        // positive fixint\n        if (prefix < 0x80) {\n            return prefix;\n        }\n        // fixmap\n        if (prefix < 0x90) {\n            return this._map(prefix & 0x0f);\n        }\n        // fixarray\n        if (prefix < 0xa0) {\n            return this._array(prefix & 0x0f);\n        }\n        // fixstr\n        return this._str(prefix & 0x1f);\n    }\n    // negative fixint\n    if (prefix > 0xdf) {\n        return (0xff - prefix + 1) * -1;\n    }\n    switch (prefix) {\n        // nil\n        case 0xc0:\n            return null;\n        // false\n        case 0xc2:\n            return false;\n        // true\n        case 0xc3:\n            return true;\n        // bin\n        case 0xc4:\n            length = this._view.getUint8(this._offset);\n            this._offset += 1;\n            return this._bin(length);\n        case 0xc5:\n            length = this._view.getUint16(this._offset);\n            this._offset += 2;\n            return this._bin(length);\n        case 0xc6:\n            length = this._view.getUint32(this._offset);\n            this._offset += 4;\n            return this._bin(length);\n        // ext\n        case 0xc7:\n            length = this._view.getUint8(this._offset);\n            type = this._view.getInt8(this._offset + 1);\n            this._offset += 2;\n            return [type, this._bin(length)];\n        case 0xc8:\n            length = this._view.getUint16(this._offset);\n            type = this._view.getInt8(this._offset + 2);\n            this._offset += 3;\n            return [type, this._bin(length)];\n        case 0xc9:\n            length = this._view.getUint32(this._offset);\n            type = this._view.getInt8(this._offset + 4);\n            this._offset += 5;\n            return [type, this._bin(length)];\n        // float\n        case 0xca:\n            value = this._view.getFloat32(this._offset);\n            this._offset += 4;\n            return value;\n        case 0xcb:\n            value = this._view.getFloat64(this._offset);\n            this._offset += 8;\n            return value;\n        // uint\n        case 0xcc:\n            value = this._view.getUint8(this._offset);\n            this._offset += 1;\n            return value;\n        case 0xcd:\n            value = this._view.getUint16(this._offset);\n            this._offset += 2;\n            return value;\n        case 0xce:\n            value = this._view.getUint32(this._offset);\n            this._offset += 4;\n            return value;\n        case 0xcf:\n            hi = this._view.getUint32(this._offset) * Math.pow(2, 32);\n            lo = this._view.getUint32(this._offset + 4);\n            this._offset += 8;\n            return hi + lo;\n        // int\n        case 0xd0:\n            value = this._view.getInt8(this._offset);\n            this._offset += 1;\n            return value;\n        case 0xd1:\n            value = this._view.getInt16(this._offset);\n            this._offset += 2;\n            return value;\n        case 0xd2:\n            value = this._view.getInt32(this._offset);\n            this._offset += 4;\n            return value;\n        case 0xd3:\n            hi = this._view.getInt32(this._offset) * Math.pow(2, 32);\n            lo = this._view.getUint32(this._offset + 4);\n            this._offset += 8;\n            return hi + lo;\n        // fixext\n        case 0xd4:\n            type = this._view.getInt8(this._offset);\n            this._offset += 1;\n            if (type === 0x00) {\n                this._offset += 1;\n                return void 0;\n            }\n            return [type, this._bin(1)];\n        case 0xd5:\n            type = this._view.getInt8(this._offset);\n            this._offset += 1;\n            return [type, this._bin(2)];\n        case 0xd6:\n            type = this._view.getInt8(this._offset);\n            this._offset += 1;\n            return [type, this._bin(4)];\n        case 0xd7:\n            type = this._view.getInt8(this._offset);\n            this._offset += 1;\n            if (type === 0x00) {\n                hi = this._view.getInt32(this._offset) * Math.pow(2, 32);\n                lo = this._view.getUint32(this._offset + 4);\n                this._offset += 8;\n                return new Date(hi + lo);\n            }\n            return [type, this._bin(8)];\n        case 0xd8:\n            type = this._view.getInt8(this._offset);\n            this._offset += 1;\n            return [type, this._bin(16)];\n        // str\n        case 0xd9:\n            length = this._view.getUint8(this._offset);\n            this._offset += 1;\n            return this._str(length);\n        case 0xda:\n            length = this._view.getUint16(this._offset);\n            this._offset += 2;\n            return this._str(length);\n        case 0xdb:\n            length = this._view.getUint32(this._offset);\n            this._offset += 4;\n            return this._str(length);\n        // array\n        case 0xdc:\n            length = this._view.getUint16(this._offset);\n            this._offset += 2;\n            return this._array(length);\n        case 0xdd:\n            length = this._view.getUint32(this._offset);\n            this._offset += 4;\n            return this._array(length);\n        // map\n        case 0xde:\n            length = this._view.getUint16(this._offset);\n            this._offset += 2;\n            return this._map(length);\n        case 0xdf:\n            length = this._view.getUint32(this._offset);\n            this._offset += 4;\n            return this._map(length);\n    }\n    throw new Error('Could not parse');\n};\nfunction decode(buffer, offset) {\n    if (offset === void 0) { offset = 0; }\n    var decoder = new Decoder(buffer, offset);\n    var value = decoder._parse();\n    if (decoder._offset !== buffer.byteLength) {\n        throw new Error((buffer.byteLength - decoder._offset) + ' trailing bytes');\n    }\n    return value;\n}\nexports.default = decode;\n"]},"metadata":{},"sourceType":"script"}